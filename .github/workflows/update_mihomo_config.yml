name: Update Mihomo Config

on:
  push:
    paths:
      - 'Mihomo/mihomo_single.yaml'
      - 'Mihomo/mihomo_multi.yaml'
      - 'Mihomo/auto_update_config/auto_update_yaml.py'
      - 'pyproject.toml'
      - 'pdm.lock'
      - '.github/workflows/update_mihomo_config.yml'
      - '.github/workflows/reusable-mihomo-update.yml'
  schedule:
    - cron: '0 13 * * *'
  workflow_dispatch:

permissions:
  contents: write

concurrency:
  group: mihomo-config-update
  cancel-in-progress: true

jobs:
  update_config:
    uses: ./.github/workflows/reusable-mihomo-update.yml
    with:
      script_name: 'auto_update_yaml.py'
      commit_message: |
        chore: update mihomo config files

        - Updated fake-ip-filter configurations
        - Auto-generated by GitHub Actions
      target_path: 'Mihomo/'
      timeout_minutes: 10